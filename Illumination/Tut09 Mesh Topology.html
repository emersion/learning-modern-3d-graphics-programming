<html><head>


<script type="text/javascript" src="/static/js/analytics.js"></script>
<script type="text/javascript">archive_analytics.values.server_name="wwwb-app3.us.archive.org";archive_analytics.values.server_ms=97;</script>
<link type="text/css" rel="stylesheet" href="/static/css/banner-styles.css"/>


      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>Mesh Topology</title><link rel="stylesheet" href="chunked.css" type="text/css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="../index.html" title="Learning Modern 3D Graphics Programming"><link rel="up" href="Tutorial 09.html" title="Chapter&nbsp;9.&nbsp;Lights On"><link rel="prev" href="Tut09 Global Illumination.html" title="Global Illumination"><link rel="next" href="Tut09 In Review.html" title="In Review"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">


<!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">//<![CDATA[
var __wm = (function(){
var wbPrefix = "/web/";
var wbCurrentUrl = "http://www.arcsynthesis.org/gltut/Illumination/Tut09%20Mesh%20Topology.html";

var firstYear = 1996;
var imgWidth = 500,imgHeight = 27;
var yearImgWidth = 25,monthImgWidth = 2;
var displayDay = "25";
var displayMonth = "Feb";
var displayYear = "2015";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
var $D=document,$=function(n){return document.getElementById(n)};
var trackerVal,curYear = -1,curMonth = -1;
var yearTracker,monthTracker;
function showTrackers(val) {
  if (val===trackerVal) return;
  var $ipp=$("wm-ipp");
  var $y=$("displayYearEl"),$m=$("displayMonthEl"),$d=$("displayDayEl");
  if (val) {
    $ipp.className="hi";
  } else {
    $ipp.className="";
    $y.innerHTML=displayYear;$m.innerHTML=displayMonth;$d.innerHTML=displayDay;
  }
  yearTracker.style.display=val?"inline":"none";
  monthTracker.style.display=val?"inline":"none";
  trackerVal = val;
}
function getElementX2(obj) {
  var $e=jQuery(obj);
  return (typeof $e=="undefined"||typeof $e.offset=="undefined")?
    getElementX(obj):Math.round($e.offset().left);
}
function trackMouseMove(event,element) {
  var eventX = getEventX(event);
  var elementX = getElementX2(element);
  var xOff = Math.min(Math.max(0, eventX - elementX),imgWidth);
  var monthOff = xOff % yearImgWidth;

  var year = Math.floor(xOff / yearImgWidth);
  var monthOfYear = Math.min(11,Math.floor(monthOff / monthImgWidth));
  // 1 extra border pixel at the left edge of the year:
  var month = (year * 12) + monthOfYear;
  var day = monthOff % 2==1?15:1;
  var dateString = zeroPad(year + firstYear) + zeroPad(monthOfYear+1,2) +
    zeroPad(day,2) + "000000";

  $("displayYearEl").innerHTML=year+firstYear;
  $("displayMonthEl").innerHTML=prettyMonths[monthOfYear];
  // looks too jarring when it changes..
  //$("displayDayEl").innerHTML=zeroPad(day,2);
  var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
  $("wm-graph-anchor").href=url;

  if(curYear != year) {
    var yrOff = year * yearImgWidth;
    yearTracker.style.left = yrOff + "px";
    curYear = year;
  }
  if(curMonth != month) {
    var mtOff = year + (month * monthImgWidth) + 1;
    monthTracker.style.left = mtOff + "px";
    curMonth = month;
  }
}
function hideToolbar() {
  $("wm-ipp").style.display="none";
}
function bootstrap() {
  var $spk=$("wm-ipp-sparkline");
  yearTracker=$D.createElement('div');
  yearTracker.className='yt';
  with(yearTracker.style){
    display='none';width=yearImgWidth+"px";height=imgHeight+"px";
  }
  monthTracker=$D.createElement('div');
  monthTracker.className='mt';
  with(monthTracker.style){
    display='none';width=monthImgWidth+"px";height=imgHeight+"px";
  }
  $spk.appendChild(yearTracker);
  $spk.appendChild(monthTracker);

  var $ipp=$("wm-ipp");
  $ipp&&disclaimElement($ipp);
}
return{st:showTrackers,mv:trackMouseMove,h:hideToolbar,bt:bootstrap};
})();//]]>
</script>
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  min-width:800px !important;
}
</style>
<div id="wm-ipp" lang="en" style="display:none;">

<div style="position:fixed;left:0;top:0;width:100%!important">
<div id="wm-ipp-inside">
   <table style="width:100%;"><tbody><tr>
   <td id="wm-logo">
       <a href="/web/" title="Wayback Machine home page"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0" /></a>
   </td>
   <td class="c">
       <table style="margin:0 auto;"><tbody><tr>
       <td class="u" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www.arcsynthesis.org/gltut/Illumination/Tut09%20Mesh%20Topology.html" style="width:400px;" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20150225192604" /><input type="submit" value="Go" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td class="n" rowspan="2">
           <table><tbody>
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr class="m">
           	<td class="b" nowrap="nowrap">
		
		    <a href="/web/20140813153331/http://www.arcsynthesis.org/gltut/Illumination/Tut09%20Mesh%20Topology.html" title="13 Aug 2014">AUG</a>
		
		</td>
		<td class="c" id="displayMonthEl" title="You are here: 19:26:04 Feb 25, 2015">FEB</td>
		<td class="f" nowrap="nowrap">
		
		    Mar
		
                </td>
	    </tr>
           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr class="d">
               <td class="b" nowrap="nowrap">
               
                   <a href="/web/20140813153331/http://www.arcsynthesis.org/gltut/Illumination/Tut09%20Mesh%20Topology.html" title="15:33:31 Aug 13, 2014"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
               
               </td>
               <td class="c" id="displayDayEl" style="width:34px;font-size:24px;" title="You are here: 19:26:04 Feb 25, 2015">25</td>
	       <td class="f" nowrap="nowrap">
               
                   <img src="/static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0"/>
               
	       </td>
           </tr>
           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr class="y">
	       <td class="b" nowrap="nowrap">
               
                   <a href="/web/20131205211513/http://www.arcsynthesis.org/gltut/Illumination/Tut09%20Mesh%20Topology.html" title="5 Dec 2013"><strong>2013</strong></a>
               
               </td>
               <td class="c" id="displayYearEl" title="You are here: 19:26:04 Feb 25, 2015">2015</td>
	       <td class="f" nowrap="nowrap">
               
                   2016
               
	       </td>
           </tr>
           </tbody></table>
       </td>
       </tr>
       <tr>
       <td class="s">
           <a class="t" href="/web/20150225192604*/http://www.arcsynthesis.org/gltut/Illumination/Tut09%20Mesh%20Topology.html" title="See a list of every capture for this URL">19 captures</a>
           <div class="r" title="Timespan for captures of this URL">29 Mar 12 - 25 Feb 15</div>
       </td>
       <td class="k">
       <a href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" title="Explore captures for this URL">
	 <img id="sparklineImgId" alt="sparklines"
		 onmouseover="__wm.st(1)" onmouseout="__wm.st(0)"
		 onmousemove="__wm.mv(event,this)"
		 width="500"
		 height="27"
		 border="0"
		 src="/web/jsp/graph.jsp?graphdata=500_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000000000000_2007:-1:000000000000_2008:-1:000000000000_2009:-1:000000000000_2010:-1:000000000000_2011:-1:000000000000_2012:-1:001110000020_2013:-1:001001211211_2014:-1:000101010000_2015:1:010000000000" />
       </div>
       </a>
       </td>
       </tr></tbody></table>
   </td>
   <td class="r">
       <a href="#close" onclick="__wm.h();return false;" style="background-image:url(/static/images/toolbar/wm_tb_close.png);top:5px;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="background-image:url(/static/images/toolbar/wm_tb_help.png);bottom:5px;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>
</div>
</div>
</div>
<script type="text/javascript">__wm.bt();</script>
<!-- END WAYBACK TOOLBAR INSERT -->
<div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Mesh Topology</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="Tut09 Global Illumination.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;9.&nbsp;Lights On</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="Tut09 In Review.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e9519"></a>Mesh Topology</h2></div></div></div><p>Thus far, we have seen three different kinds of vertex attributes. We have used
            positions, colors, and now normals. Before we can continue, we need to discuss the
            ramifications of having three independent vertex attributes on our meshes.</p><p>A mesh's <em class="glossterm">topology</em> defines the
            connectedness between the vertices. However, each vertex attribute can have its own
            separate topology. How is this possible?</p><p>Consider a simple cube. It has 8 vertex positions. The topology between the positions
            of the cube is as follows:</p><div class="figure"><a name="d0e9532"></a><p class="title"><b>Figure&nbsp;9.12.&nbsp;Cube Position Topology</b></p><div class="figure-contents"><div class="mediaobject"><img src="CubePositionTopology.svg" alt="Cube Position Topology"></div></div></div><br class="figure-break"><p>The topology diagram has the 8 different positions, with each position connected to
            three neighbors. The connections represent the edges of the cube faces, and the area
            bounded by connections represent the faces themselves. So each face has four edges and
            four positions.</p><p>Now consider the topology of the normals of a cube. A cube has 6 faces, each of which
            has a distinct normal. The topology is a bit unorthodox:</p><div class="figure"><a name="d0e9542"></a><p class="title"><b>Figure&nbsp;9.13.&nbsp;Cube Normal Topology</b></p><div class="figure-contents"><div class="mediaobject"><img src="CubeNormalTopology.svg" alt="Cube Normal Topology"></div></div></div><br class="figure-break"><p>The square points represent distinct normals, not positions in space. The connections
            between normals all loop back on themselves. That's because each vertex of each face
            uses the same normal. While the front face and the top face share two vertex positions
            in common, they share no vertex normals at all. Therefore, there is no topological
            relation between the front normal and the top normal. Each normal value is connected to
            itself four times, but it is connected to nothing else.</p><p>We have 8 positions and 6 normals. They each have a unique topology over the mesh. How
            do we turn this into something we can render?</p><p>If we knew nothing about OpenGL, this would be simple. We simply use the topologies to
            build the meshes. Each face is broken down into two triangles. We would have an array of
            8 positions and 6 normals. And for each vertex we render, we would have a list of
            indices that fetch values from these two arrays.</p><p>The index list for two faces of the cube might look like this (using a C++-style
            multidimensional list):</p><pre class="programlisting">{
  {<span class="code-number">0</span>, <span class="code-number">0</span>}, {<span class="code-number">1</span>, <span class="code-number">0</span>}, {<span class="code-number">2</span>, <span class="code-number">0</span>}, {<span class="code-number">1</span>, <span class="code-number">0</span>}, {<span class="code-number">3</span>, <span class="code-number">0</span>}, {<span class="code-number">2</span>, <span class="code-number">0</span>},
  {<span class="code-number">0</span>, <span class="code-number">1</span>}, {<span class="code-number">4</span>, <span class="code-number">1</span>}, {<span class="code-number">1</span>, <span class="code-number">1</span>}, {<span class="code-number">4</span>, <span class="code-number">1</span>}, {<span class="code-number">6</span>, <span class="code-number">1</span>}, {<span class="code-number">1</span>, <span class="code-number">1</span>},
}</pre><p>The first index in each element of the list pulls from the position array, and the
            second index pulls from the normal array. This list explicitly specifies the
            relationship between faces and topology: the first face (composed of two triangles)
            contains 4 positions, but uses the same normal for all vertices. The second face shares
            two positions with the first, but no normals.</p><p>This is complicated in OpenGL because of one simple reason: we only get
                <span class="emphasis"><em>one</em></span> index list. When we render with an index array, every
            attribute array uses the same index. Therefore, what we need to do is convert the above
            index list into a list of unique combinations of vertex attributes. So each pair of
            indices must refer to a unique index.</p><p>Consider the first face. It consists of 4 unique vertices; the index pairs {1, 0} and
            {2, 0} are repeated, since we must draw triangles. Since these pairs are repeats, we can
            collapse them; they will refer to the same index. However, the fact that each vertex
            uses the same normal must be ignored entirely. Therefore, the final index list we use
            for the first face is:</p><pre class="programlisting">{ <span class="code-number">0</span>, <span class="code-number">1</span>, <span class="code-number">2</span>, <span class="code-number">1</span>, <span class="code-number">3</span>, <span class="code-number">2</span> }</pre><p>The attribute arrays for this one face contain 4 positions and 4 normals. But while
            the positions are all different, the normals must all be the same value. Even though
            they are stored in four separate locations. This seems like a waste of memory.</p><p>This gets worse once we move on to the next face. Because we can only collapse index
            pairs that are identical, absolutely none of the vertices in the second face share
            indices with the first face. The fact that we reuse two positions in the next face is
            irrelevant: we must have the following index list:</p><pre class="programlisting">{ <span class="code-number">4</span>, <span class="code-number">5</span>, <span class="code-number">6</span>, <span class="code-number">5</span>, <span class="code-number">7</span>, <span class="code-number">6</span> }</pre><p>The attribute array for both faces contains 8 positions and 8 normals. Again, the
            normals for the second face are all duplicates of each other. And there are two
            positions that are duplicated. Topologically speaking, our cube vertex topology looks
            like the following:</p><div class="figure"><a name="d0e9577"></a><p class="title"><b>Figure&nbsp;9.14.&nbsp;Full Cube Topology</b></p><div class="figure-contents"><div class="mediaobject"><img src="CubeTotalTopology.svg" alt="Full Cube Topology"></div></div></div><br class="figure-break"><p>Each face is entirely distinct topologically from the rest.</p><p>In the end, this gives us 24 positions and 24 normals in our arrays. There will only
            be 6 distinct normal values and 8 distinct position values in the array, but there will
            be 24 of each. So this represents a significant increase in our data size.</p><p>Do not be too concerned about the increase in data however. A cube, or any other
            faceted object, represents the worst-case scenario for this kind of conversion. Most
            actual meshes of smooth objects have much more interconnected topologies.</p><p>Mesh topology is something to be aware of, as is the ability to convert attribute
            topologies into forms that OpenGL can directly process. Each attribute has its own
            topology which affects how the index list is built. Different attributes can share the
            same topology. For example, we could have colors associated with each face of the cube.
            The color topology would be identical to the normal topology.</p><p>Most of the details are usually hidden behind various command-line tools that are used
            to generate proper meshes from files exported from modelling programs. Many videogame
            developers have complex asset conditioning pipelines that process exported files into
            binary formats suitable for loading and direct upload into buffer objects. But it is
            important to understand how mesh topologies work.</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="Tut09 Global Illumination.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="Tutorial 09.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="Tut09 In Review.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Global Illumination&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="/web/20150225192604/http://www.arcsynthesis.org/gltut/index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;In Review</td></tr></table></div></body></html>




<!--
     FILE ARCHIVED ON 19:26:04 Feb 25, 2015 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 19:09:18 Mar 29, 2015.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
