<html><head>


<script type="text/javascript" src="/static/js/analytics.js"></script>
<script type="text/javascript">archive_analytics.values.server_name="wwwb-app12.us.archive.org";archive_analytics.values.server_ms=232;</script>
<link type="text/css" rel="stylesheet" href="/static/css/banner-styles.css"/>


      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>Gaussian</title><link rel="stylesheet" href="chunked.css" type="text/css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="../index.html" title="Learning Modern 3D Graphics Programming"><link rel="up" href="Tutorial 11.html" title="Chapter&nbsp;11.&nbsp;Shinies"><link rel="prev" href="Tut11 BlinnPhong Model.html" title="Blinn-Phong Model"><link rel="next" href="Tut11 On Performance.html" title="On Performance"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">


<!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">//<![CDATA[
var __wm = (function(){
var wbPrefix = "/web/";
var wbCurrentUrl = "http://www.arcsynthesis.org/gltut/Illumination/Tut11%20Gaussian.html";

var firstYear = 1996;
var imgWidth = 500,imgHeight = 27;
var yearImgWidth = 25,monthImgWidth = 2;
var displayDay = "25";
var displayMonth = "Feb";
var displayYear = "2015";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
var $D=document,$=function(n){return document.getElementById(n)};
var trackerVal,curYear = -1,curMonth = -1;
var yearTracker,monthTracker;
function showTrackers(val) {
  if (val===trackerVal) return;
  var $ipp=$("wm-ipp");
  var $y=$("displayYearEl"),$m=$("displayMonthEl"),$d=$("displayDayEl");
  if (val) {
    $ipp.className="hi";
  } else {
    $ipp.className="";
    $y.innerHTML=displayYear;$m.innerHTML=displayMonth;$d.innerHTML=displayDay;
  }
  yearTracker.style.display=val?"inline":"none";
  monthTracker.style.display=val?"inline":"none";
  trackerVal = val;
}
function getElementX2(obj) {
  var $e=jQuery(obj);
  return (typeof $e=="undefined"||typeof $e.offset=="undefined")?
    getElementX(obj):Math.round($e.offset().left);
}
function trackMouseMove(event,element) {
  var eventX = getEventX(event);
  var elementX = getElementX2(element);
  var xOff = Math.min(Math.max(0, eventX - elementX),imgWidth);
  var monthOff = xOff % yearImgWidth;

  var year = Math.floor(xOff / yearImgWidth);
  var monthOfYear = Math.min(11,Math.floor(monthOff / monthImgWidth));
  // 1 extra border pixel at the left edge of the year:
  var month = (year * 12) + monthOfYear;
  var day = monthOff % 2==1?15:1;
  var dateString = zeroPad(year + firstYear) + zeroPad(monthOfYear+1,2) +
    zeroPad(day,2) + "000000";

  $("displayYearEl").innerHTML=year+firstYear;
  $("displayMonthEl").innerHTML=prettyMonths[monthOfYear];
  // looks too jarring when it changes..
  //$("displayDayEl").innerHTML=zeroPad(day,2);
  var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
  $("wm-graph-anchor").href=url;

  if(curYear != year) {
    var yrOff = year * yearImgWidth;
    yearTracker.style.left = yrOff + "px";
    curYear = year;
  }
  if(curMonth != month) {
    var mtOff = year + (month * monthImgWidth) + 1;
    monthTracker.style.left = mtOff + "px";
    curMonth = month;
  }
}
function hideToolbar() {
  $("wm-ipp").style.display="none";
}
function bootstrap() {
  var $spk=$("wm-ipp-sparkline");
  yearTracker=$D.createElement('div');
  yearTracker.className='yt';
  with(yearTracker.style){
    display='none';width=yearImgWidth+"px";height=imgHeight+"px";
  }
  monthTracker=$D.createElement('div');
  monthTracker.className='mt';
  with(monthTracker.style){
    display='none';width=monthImgWidth+"px";height=imgHeight+"px";
  }
  $spk.appendChild(yearTracker);
  $spk.appendChild(monthTracker);

  var $ipp=$("wm-ipp");
  $ipp&&disclaimElement($ipp);
}
return{st:showTrackers,mv:trackMouseMove,h:hideToolbar,bt:bootstrap};
})();//]]>
</script>
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  min-width:800px !important;
}
</style>
<div id="wm-ipp" lang="en" style="display:none;">

<div style="position:fixed;left:0;top:0;width:100%!important">
<div id="wm-ipp-inside">
   <table style="width:100%;"><tbody><tr>
   <td id="wm-logo">
       <a href="/web/" title="Wayback Machine home page"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0" /></a>
   </td>
   <td class="c">
       <table style="margin:0 auto;"><tbody><tr>
       <td class="u" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www.arcsynthesis.org/gltut/Illumination/Tut11%20Gaussian.html" style="width:400px;" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20150225192609" /><input type="submit" value="Go" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td class="n" rowspan="2">
           <table><tbody>
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr class="m">
           	<td class="b" nowrap="nowrap">
		
		    <a href="/web/20140813145439/http://www.arcsynthesis.org/gltut/Illumination/Tut11%20Gaussian.html" title="13 Aug 2014">AUG</a>
		
		</td>
		<td class="c" id="displayMonthEl" title="You are here: 19:26:09 Feb 25, 2015">FEB</td>
		<td class="f" nowrap="nowrap">
		
		    Mar
		
                </td>
	    </tr>
           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr class="d">
               <td class="b" nowrap="nowrap">
               
                   <a href="/web/20140813145439/http://www.arcsynthesis.org/gltut/Illumination/Tut11%20Gaussian.html" title="14:54:39 Aug 13, 2014"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
               
               </td>
               <td class="c" id="displayDayEl" style="width:34px;font-size:24px;" title="You are here: 19:26:09 Feb 25, 2015">25</td>
	       <td class="f" nowrap="nowrap">
               
                   <img src="/static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0"/>
               
	       </td>
           </tr>
           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr class="y">
	       <td class="b" nowrap="nowrap">
               
                   <a href="/web/20131205205845/http://www.arcsynthesis.org/gltut/Illumination/Tut11%20Gaussian.html" title="5 Dec 2013"><strong>2013</strong></a>
               
               </td>
               <td class="c" id="displayYearEl" title="You are here: 19:26:09 Feb 25, 2015">2015</td>
	       <td class="f" nowrap="nowrap">
               
                   2016
               
	       </td>
           </tr>
           </tbody></table>
       </td>
       </tr>
       <tr>
       <td class="s">
           <a class="t" href="/web/20150225192609*/http://www.arcsynthesis.org/gltut/Illumination/Tut11%20Gaussian.html" title="See a list of every capture for this URL">38 captures</a>
           <div class="r" title="Timespan for captures of this URL">8 May 11 - 25 Feb 15</div>
       </td>
       <td class="k">
       <a href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" title="Explore captures for this URL">
	 <img id="sparklineImgId" alt="sparklines"
		 onmouseover="__wm.st(1)" onmouseout="__wm.st(0)"
		 onmousemove="__wm.mv(event,this)"
		 width="500"
		 height="27"
		 border="0"
		 src="/web/jsp/graph.jsp?graphdata=500_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000000000000_2007:-1:000000000000_2008:-1:000000000000_2009:-1:000000000000_2010:-1:000000000000_2011:-1:000010111020_2012:-1:211110000131_2013:-1:112111211211_2014:-1:000103010000_2015:1:010000000000" />
       </div>
       </a>
       </td>
       </tr></tbody></table>
   </td>
   <td class="r">
       <a href="#close" onclick="__wm.h();return false;" style="background-image:url(/static/images/toolbar/wm_tb_close.png);top:5px;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="background-image:url(/static/images/toolbar/wm_tb_help.png);bottom:5px;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>
</div>
</div>
</div>
<script type="text/javascript">__wm.bt();</script>
<!-- END WAYBACK TOOLBAR INSERT -->
<div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Gaussian</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="Tut11 BlinnPhong Model.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;11.&nbsp;Shinies</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="Tut11 On Performance.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e11216"></a>Gaussian</h2></div></div></div><p>Phong and Blinn are nice toy heuristics that take relatively little computational
            power. But if you're truly serious about computing specular highlights, you need a model
            that actually <span class="emphasis"><em>models</em></span> microfacets.</p><p>Real microfacet models are primarily based on the answer to the question <span class="quote">&#8220;<span class="quote">What
                proportion of the microfacets of this surface are oriented in such a way as to
                specularly reflect light towards the viewer?</span>&#8221;</span> The greater the proportion of
            properly oriented microfacets, the stronger the reflected light. This question is
            ultimately one of statistics.</p><p>Thus it makes sense to model this as a probability distribution. We know that the
            average microfacet orientation is the surface normal. So it's just a matter of
            developing a probability distribution function that says what portion of the surface's
            microfacets are oriented to provide specular reflections given the light direction and
            the view direction.</p><p>In statistics, the very first place you go for modelling anything with a probability
            distribution is to the <em class="glossterm">normal distribtuion</em> or <em class="glossterm">Gaussian
                distribution.</em> It may not be the correct distribution that physically
            models what the microfacet distribution of a surface looks like, but it's usually a good
            starting point.</p><p>The Gaussian distribution is the classic <span class="quote">&#8220;<span class="quote">bell-shaped curve</span>&#8221;</span>
            distribution. The mathematical function for computing the probability density of the
            Gaussian distribution at a particular point X is:</p><div class="equation"><a name="d0e11245"></a><p class="title"><b>Equation&nbsp;11.5.&nbsp;Gaussian Distribution Function</b></p><div class="equation-contents"><div class="mediaobject"><img src="GaussianDistributionEq.svg"></div></div></div><br class="equation-break"><div class="figure"><a name="d0e11251"></a><p class="title"><b>Figure&nbsp;11.14.&nbsp;Gaussian Probability Distribution Curves</b></p><div class="figure-contents"><div class="mediaobject"><img src="GaussianPlot.svg" alt="Gaussian Probability Distribution Curves"></div></div></div><br class="figure-break"><p>This represents the percentage of the items in the distribution that satisfy the
            property that the X in the distribution is trying to model. The <code class="literal">e</code> in
            this equation is a common mathematical constant, equivalent to ~2.718. The value of
                <code class="varname">&#956;</code> is the average. So the absolute value of X is not important;
            what matters is how far X is from the average.</p><p>The value <code class="varname">&#963;<sup>2</sup></code> is the variance of the
            Gaussian distribution. Without getting too technical, the larger this value becomes, the
            flatter and wider the distribution is. The variance specifies how far from the average
            you can get to achieve a certain probability density. The area of the distribution that
            is positive and negative <code class="varname">&#963;</code> away from the average takes up ~68% of the
            possible values. The area that is 2<code class="varname">&#963;</code> away represents ~95% of the
            possible values.</p><p>We know what the average is for us: the surface normal. We can incorporate what we
            learned from Blinn, by measuring the distance from perfect reflection by comparing the
            surface normal to the half-angle vector. Thus, the X values represents the angle between
            the surface normal and half-angle vector. The value <code class="varname">&#956;</code>, the average,
            is zero.</p><p>The equation we will be using for modelling the microfacet distribution with a
            Gaussian distribution is a slightly simplified form of the Gaussian distribution
            equation.</p><div class="equation"><a name="d0e11285"></a><p class="title"><b>Equation&nbsp;11.6.&nbsp;Gaussian Specular Term</b></p><div class="equation-contents"><div class="mediaobject"><img src="GaussianTerm.svg"></div></div></div><br class="equation-break"><p>This replaces our Phong and Blinn terms in our specular lighting equation and gives us
            the <em class="glossterm">Gaussian specular model</em>. The value <code class="varname">m</code>
            ranges from (0, 1], with larger values representing an increasingly rougher surface.
            Technically, you can use values larger than 1, but the results begin looking
            increasingly less useful. A value of 1 is plenty rough enough for specular reflection;
            properly modelling extremely rough surfaces requires additional computations besides
            determining the distribution of microfacets.</p><p>The <span>Gaussian Specular Lighting</span> tutorial shows an implementation of
            Gaussian specular. It allows a comparison between Phong, Blinn, and Gaussian. It
            controls the same as the previous tutorial, with the <span class="keycap"><strong>H</strong></span> key switching
            between the three specular computations, and the <span class="keycap"><strong>Shift</strong></span>+<span class="keycap"><strong>H</strong></span> switching between diffuse+specular and specular only.</p><p>Here is the fragment shader for doing Gaussian lighting.</p><div class="example"><a name="d0e11315"></a><p class="title"><b>Example&nbsp;11.3.&nbsp;Gaussian Lighting Shader</b></p><div class="example-contents"><pre class="programlisting"><span class="code-type">vec3</span> lightDir = <span class="code-type">vec3</span>(<span class="code-number">0.0</span>);
<span class="code-type">float</span> atten = CalcAttenuation(cameraSpacePosition, lightDir);
<span class="code-type">vec4</span> attenIntensity = atten * lightIntensity;

<span class="code-type">vec3</span> surfaceNormal = <span class="code-function">normalize</span>(vertexNormal);
<span class="code-type">float</span> cosAngIncidence = <span class="code-function">dot</span>(surfaceNormal, lightDir);
cosAngIncidence = <span class="code-function">clamp</span>(cosAngIncidence, <span class="code-number">0</span>, <span class="code-number">1</span>);

<span class="code-type">vec3</span> viewDirection = <span class="code-function">normalize</span>(-cameraSpacePosition);

<span class="code-type">vec3</span> halfAngle = <span class="code-function">normalize</span>(lightDir + viewDirection);
<span class="code-type">float</span> angleNormalHalf = <span class="code-function">acos</span>(<span class="code-function">dot</span>(halfAngle, surfaceNormal));
<span class="code-type">float</span> exponent = angleNormalHalf / shininessFactor;
exponent = -(exponent * exponent);
<span class="code-type">float</span> gaussianTerm = <span class="code-function">exp</span>(exponent);

gaussianTerm = cosAngIncidence != <span class="code-number">0.0</span> ? gaussianTerm : <span class="code-number">0.0</span>;

outputColor = (diffuseColor * attenIntensity * cosAngIncidence) +
    (specularColor * attenIntensity * gaussianTerm) +
    (diffuseColor * ambientIntensity);</pre></div></div><br class="example-break"><p>Computing the angle between the half-angle vector and the surface normal requires the
            use of the <code class="function">acos</code> function. We use the dot-product to compute the
            cosine of the angle, so we need a function to undo the cosine operation. The
                <em class="glossterm">arc cosine</em> or <em class="glossterm">inverse cosine</em> function
            takes the result of a cosine and returns the angle that produced that value.</p><p>To do the exponentiation, we use the <code class="function">exp</code> function. This function
            raises the constant <code class="literal">e</code> to the power of the argument. Everything else
            proceeds as expected.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e11339"></a>What Gaussian Offers</h3></div></div></div><p>If you play around with the controls, you can see how much the Gaussian
                distribution offers over Phong and Blinn. For example, set the Gaussian smoothness
                value to 0.05.</p><div class="figure"><a name="d0e11344"></a><p class="title"><b>Figure&nbsp;11.15.&nbsp;Gaussian with Sharp Highlight</b></p><div class="figure-contents"><div class="mediaobject"><img src="Gaussian%20Small%20Highlight.png" alt="Gaussian with Sharp Highlight"></div></div></div><br class="figure-break"><p>It requires very large exponents, well in excess of 100, to match the small size
                and focus of that specular highlight with Phong or Blinn. It takes even larger
                exponents to match the Gaussian value of 0.02.</p><p>Otherwise the differences between Gaussian and Blinn are fairly subtle. For rough
                surfaces, there is little substantive difference. But Gaussian tends to have a
                sharper, more distinct highlight for shiny surfaces.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="Tut11 BlinnPhong Model.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="Tutorial 11.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="Tut11 On Performance.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Blinn-Phong Model&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="/web/20150225192609/http://www.arcsynthesis.org/gltut/index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;On Performance</td></tr></table></div></body></html>




<!--
     FILE ARCHIVED ON 19:26:09 Feb 25, 2015 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 19:09:25 Mar 29, 2015.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
